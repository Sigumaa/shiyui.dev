---
import PageLayout from '@/layouts/CommonPage.astro'

type SubscriptionItem = {
  name: string
  description?: string
  price?: string
  renewal?: string
  status?: string
  link?: string
}

type SubscriptionCategory = {
  label: string
  items: SubscriptionItem[]
}

const subscriptionCategories: SubscriptionCategory[] = [
  {
    label: 'Streaming / Music',
    items: [
      {
        name: 'YouTube Premium',
        status: '動画',
        description: '広告なし視聴とバックグラウンド再生で情報収集をしやすくする。'
      },
      {
        name: 'Spotify Premium',
        status: '音楽',
        description: 'クラブミュージックの新譜チェックやプレイリスト管理用。'
      },
      {
        name: 'Apple Music',
        status: '音楽',
        description: 'ロスレスや空間オーディオの試聴、新譜掘りのサブチャンネル。'
      },
      {
        name: 'dアニメストア',
        status: 'アニメ',
        description: 'アーカイブの振り返りと気になる作品の週次ウォッチ。'
      },
      {
        name: 'Netflix Standard',
        status: '動画',
        description: '長編ドラマや映画、ドキュメンタリーの視聴に利用。'
      }
    ]
  },
  {
    label: 'Social / Community',
    items: [
      {
        name: 'X Premium',
        status: 'SNS',
        description: '長文投稿やブックマーク整理、アナリティクス確認に使用。'
      },
      {
        name: 'Discord Nitro',
        status: 'コミュニティ',
        description: '所属サーバのカスタム絵文字・画質向上とブースト確保。'
      },
      {
        name: 'VRChat Plus',
        status: 'コミュニティ',
        description: 'アバターアップロード枠やワールド検索強化のために契約。'
      }
    ]
  },
  {
    label: 'Work / Development',
    items: [
      {
        name: 'ChatGPT Plus',
        status: 'AI 支援',
        description: '要件整理や文章校正、英語でのドラフト作成に活用。'
      },
      {
        name: 'Google AI Pro',
        status: 'AI 支援',
        description: 'Gemini のマルチモーダル検証と社内提案資料の試作に利用。'
      },
      {
        name: 'GitHub Pro',
        status: '開発',
        description: 'プライベートリポジトリや Copilot 連携を維持するための契約。'
      },
      {
        name: 'freee 会計 スタンダード',
        status: '会計',
        description: '個人事業主の経理処理、請求書発行、確定申告の管理に使用。'
      },
      {
        name: 'shiyui.dev ドメイン',
        status: 'インフラ',
        description: 'ポートフォリオとメール用に維持している独自ドメイン。'
      }
    ]
  },
  {
    label: 'Lifestyle',
    items: [
      {
        name: 'Uber One',
        status: 'フード / 配送',
        description: '配送料優遇とリワードで外出時の食事を安定運用。'
      },
      {
        name: 'Amazon Prime',
        status: '配送 / 動画',
        description: '配送の定額化に加え、Prime Video・Prime Music の補助用途。'
      }
    ]
  }
]

const toSlug = (value: string) =>
  value
    .toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/(^-|-$)/g, '') || 'section'

const headings = subscriptionCategories.map((category) => ({
  depth: 2,
  slug: toSlug(category.label),
  text: category.label
}))
---

<PageLayout title='Subscriptions' {headings}>
  <div class='mt-4 flex flex-col gap-10'>
    {subscriptionCategories.map((category) => {
      const slug = toSlug(category.label)
      return (
        <section id={slug} class='space-y-4'>
          <h2 class='text-xl font-semibold text-foreground'>{category.label}</h2>
          <div class='flex flex-col gap-4'>
            {category.items.map((item) => (
              <article class='rounded-lg border border-border/50 bg-muted/10 px-4 py-3 shadow-sm'>
                <div class='flex flex-col gap-1.5 sm:flex-row sm:items-center sm:justify-between'>
                  <h3 class='m-0 text-sm font-semibold leading-snug text-foreground'>{item.name}</h3>
                  <div class='flex flex-wrap gap-1.5 text-[0.65rem] uppercase tracking-wide text-muted-foreground'>
                    {item.status && (
                      <span class='rounded-full border border-border/40 bg-background/60 px-2 py-0.5'>{item.status}</span>
                    )}
                    {item.price && (
                      <span class='rounded-full border border-border/40 bg-background/60 px-2 py-0.5'>{item.price}</span>
                    )}
                    {item.renewal && (
                      <span class='rounded-full border border-border/40 bg-background/60 px-2 py-0.5'>{item.renewal}</span>
                    )}
                  </div>
                </div>
                {item.link && (
                  <div class='mt-2 text-xs'>
                    <a
                      href={item.link}
                      target='_blank'
                      rel='noreferrer noopener'
                      class='text-primary hover:underline'
                    >
                      詳細を見る
                    </a>
                  </div>
                )}
              </article>
            ))}
          </div>
        </section>
      )
    })}
  </div>
</PageLayout>
